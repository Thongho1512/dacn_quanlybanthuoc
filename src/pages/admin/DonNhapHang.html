<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Qu·∫£n l√Ω ƒë∆°n nh·∫≠p h√†ng - H·ªá th·ªëng qu·∫£n l√Ω b√°n thu·ªëc" />
  <title>Qu·∫£n l√Ω ƒë∆°n nh·∫≠p h√†ng - AdminPro</title>

  <!-- CSS -->
  <link rel="stylesheet" href="../../css/reset.css" />
  <link rel="stylesheet" href="../../css/base.css" />
  <link rel="stylesheet" href="../../css/dashboard.css" />
  
  <style>
    /* Modal larger for this form */
    #import-order-modal .modal {
      max-width: 1200px !important;
    }

    /* Chi ti·∫øt l√¥ h√†ng styles */
    .batch-details-list {
      margin-top: 16px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      overflow-x: auto;
      background: white;
    }

    .batch-detail-item {
      display: grid;
      grid-template-columns: 2.5fr 1.2fr 1.2fr 1.2fr 0.8fr 1.2fr 1.2fr 60px;
      gap: 12px;
      padding: 12px;
      border-bottom: 1px solid #f1f5f9;
      align-items: center;
      min-width: 1000px;
    }

    .batch-detail-item:last-child {
      border-bottom: none;
    }

    .batch-detail-header {
      background: #f8fafc;
      font-weight: 600;
      color: #475569;
      font-size: 13px;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .form-select-small, .form-input-small {
      padding: 8px 10px;
      font-size: 13px;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      width: 100%;
      box-sizing: border-box;
    }

    .form-input-small:focus,
    .form-select-small:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .btn-remove {
      padding: 6px;
      background: #fee2e2;
      color: #dc2626;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.2s;
      white-space: nowrap;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-remove:hover {
      background: #fecaca;
      transform: scale(1.1);
    }

    .order-summary {
      margin-top: 24px;
      padding: 20px;
      background: #f8fafc;
      border-radius: 8px;
      border: 2px solid #e2e8f0;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      font-size: 18px;
      font-weight: 700;
      color: #1e293b;
    }

    .summary-label {
      color: #64748b;
    }

    .summary-value {
      color: #16a34a;
      font-size: 20px;
    }

    .detail-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }

    .validation-note {
      margin-top: 12px;
      padding: 12px;
      background: #fef3c7;
      border: 1px solid #fbbf24;
      border-radius: 6px;
      font-size: 13px;
      color: #92400e;
    }

    .validation-note ul {
      margin: 8px 0 0 20px;
    }

    .validation-note li {
      margin: 4px 0;
    }

    /* Scrollable modal body */
    #import-order-modal .modal-body {
      max-height: calc(90vh - 200px);
      overflow-y: auto;
    }

    /* Form actions at bottom */
    .import-order-form .form-actions {
      position: relative;
      bottom: auto;
      margin-top: 24px;
      padding-top: 20px;
      border-top: 2px solid #e2e8f0;
      background: white;
    }

    .batch-details-container {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      margin-top: 12px;
    }

    @media (max-width: 1024px) {
      .batch-detail-item {
        grid-template-columns: 1fr;
        gap: 8px;
        min-width: auto;
      }

      .detail-grid {
        grid-template-columns: 1fr;
      }

      #import-order-modal .modal {
        max-width: 95% !important;
      }
    }
  </style>
</head>

<body>
  <div class="dashboard-container">
    <div id="header"></div>
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <div class="main-layout">
      <div id="sidebar-container"></div>

      <main class="content-area">
        <div class="page-header">
          <h1 class="page-title">üì¶ Qu·∫£n l√Ω ƒë∆°n nh·∫≠p h√†ng</h1>
          <p class="page-subtitle">T·∫°o v√† qu·∫£n l√Ω ƒë∆°n nh·∫≠p h√†ng t·ª´ nh√† cung c·∫•p</p>
        </div>

        <div class="toolbar">
          <div id="search-container"></div>

          <button class="btn btn-primary" id="add-import-order-btn">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
              <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
            </svg>
            T·∫°o ƒë∆°n nh·∫≠p h√†ng
          </button>
        </div>

        <div id="table-container"></div>
      </main>
    </div>

    <div id="footer"></div>
  </div>

  <div id="modal-root"></div>

  <!-- FORM TEMPLATE -->
  <template id="import-order-form-template">
    <form id="import-order-form" class="import-order-form">
      <!-- Grid 2 c·ªôt cho th√¥ng tin chung -->
      <div class="detail-grid">
        <!-- CHI NH√ÅNH -->
        <div class="form-group">
          <label class="form-label" for="idchiNhanh">
            Chi nh√°nh <span class="required">*</span>
          </label>
          <select class="form-select" id="idchiNhanh" name="idchiNhanh" required>
            <option value="">-- Ch·ªçn chi nh√°nh --</option>
          </select>
          <small class="form-note" style="color: #64748b; font-size: 12px; display: block; margin-top: 4px;">
            Chi nh√°nh s·∫Ω nh·∫≠n h√†ng t·ª´ nh√† cung c·∫•p
          </small>
        </div>

        <!-- NH√Ä CUNG C·∫§P -->
        <div class="form-group">
          <label class="form-label" for="idnhaCungCap">
            Nh√† cung c·∫•p <span class="required">*</span>
          </label>
          <select class="form-select" id="idnhaCungCap" name="idnhaCungCap" required>
            <option value="">-- Ch·ªçn nh√† cung c·∫•p --</option>
          </select>
          <small class="form-note" style="color: #64748b; font-size: 12px; display: block; margin-top: 4px;">
            Nh√† cung c·∫•p cung c·∫•p h√†ng cho ƒë∆°n n√†y
          </small>
        </div>
      </div>

      <!-- S·ªê ƒê∆†N NH·∫¨P & NG√ÄY NH·∫¨P -->
      <div class="detail-grid">
        <div class="form-group">
          <label class="form-label" for="soDonNhap">
            S·ªë ƒë∆°n nh·∫≠p <span class="required">*</span>
          </label>
          <input
            type="text"
            class="form-input"
            id="soDonNhap"
            name="soDonNhap"
            placeholder="V√≠ d·ª•: DNH-2024-001"
            required
            minlength="3"
            maxlength="50" />
          <small class="form-note" style="color: #64748b; font-size: 12px; display: block; margin-top: 4px;">
            M√£ s·ªë ƒë∆°n nh·∫≠p duy nh·∫•t (3-50 k√Ω t·ª±)
          </small>
        </div>

        <div class="form-group">
          <label class="form-label" for="ngayNhap">
            Ng√†y nh·∫≠p <span class="required">*</span>
          </label>
          <input
            type="date"
            class="form-input"
            id="ngayNhap"
            name="ngayNhap"
            required
            max="9999-12-31" />
          <small class="form-note" style="color: #64748b; font-size: 12px; display: block; margin-top: 4px;">
            Ng√†y nh·∫≠n h√†ng t·ª´ nh√† cung c·∫•p
          </small>
        </div>
      </div>

      <!-- CHI TI·∫æT L√î H√ÄNG -->
      <div class="form-group">
        <label class="form-label">
          Chi ti·∫øt l√¥ h√†ng <span class="required">*</span>
        </label>
        
        <div class="validation-note">
          <strong>‚ö†Ô∏è L∆∞u √Ω quan tr·ªçng:</strong>
          <ul>
            <li>Ng√†y h·∫øt h·∫°n ph·∫£i sau ng√†y s·∫£n xu·∫•t</li>
            <li>S·ªë l√¥ ph·∫£i duy nh·∫•t cho m·ªói thu·ªëc</li>
            <li>Gi√° nh·∫≠p ph·∫£i l·ªõn h∆°n 0</li>
            <li>Kho h√†ng s·∫Ω t·ª± ƒë·ªông ƒë∆∞·ª£c c·∫≠p nh·∫≠t sau khi t·∫°o ƒë∆°n</li>
          </ul>
        </div>
        
        <div class="batch-details-container">
          <div class="batch-details-list">
            <div class="batch-detail-item batch-detail-header">
              <div>Thu·ªëc</div>
              <div>S·ªë l√¥</div>
              <div>Ng√†y SX</div>
              <div>Ng√†y HSD</div>
              <div>SL</div>
              <div>Gi√° nh·∫≠p</div>
              <div>Th√†nh ti·ªÅn</div>
              <div></div>
            </div>
          </div>
        </div>

        <button type="button" class="btn btn-secondary" id="add-detail-btn" style="margin-top: 12px;">
          ‚ûï Th√™m l√¥ h√†ng
        </button>
      </div>

      <!-- T·ªîNG K·∫æT -->
      <div class="order-summary">
        <div class="summary-row">
          <span class="summary-label">T·ªïng ti·ªÅn ƒë∆°n nh·∫≠p:</span>
          <span class="summary-value" id="summary-total">0 ‚Ç´</span>
        </div>
        <div style="margin-top: 12px; font-size: 13px; color: #64748b;">
          <strong>üí° Th√¥ng tin:</strong> H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông c·∫≠p nh·∫≠t kho h√†ng v√† t·∫°o l√¥ h√†ng m·ªõi sau khi ƒë∆°n nh·∫≠p ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng.
        </div>
      </div>

      <!-- FORM ACTIONS -->
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" id="cancel-btn">
          H·ªßy
        </button>
        <button type="submit" class="btn btn-primary" id="submit-btn">
          <span class="btn-text">üíæ T·∫°o ƒë∆°n nh·∫≠p h√†ng</span>
          <span class="btn-loading" style="display: none">
            <span class="loading-spinner"></span> ƒêang x·ª≠ l√Ω...
          </span>
        </button>
      </div>
    </form>
  </template>

  <script type="module" src="../../js/pages/admin/DonNhapHang.js"></script>
</body>
</html>